# 实训个人作业

## Restful API 设计及使用说明 

### 1.用户注册以及登录场景

#### 1) 注册用户

- **资源标识**：/register

- **操作**：POST

- **权限**：所有用户

- **请求 payload**：包括用户名、密码、联系方式、真实身份信息等

- **应答 payload**：注册成功或失败的消息

- **url**:http://localhost:20000/register?username=ss&password=123456&roleId=1

- ```
  {
      "msg": "success",
      "result": "注册成功",
      "code": 0
  }
  ```

#### 2) 用户登录

- **资源标识**：/login

- **操作**：POST

- **权限**：所有用户

- **请求 payload**：用户名和密码

- **应答 payload**：登录成功后返回认证令牌（JWT Token在Authorization头中）![image-20240507203107296](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507203107296.png)以及用户信息

- **url:**http://localhost:20000/login?username=ss&password=123456

- ```
  {
      "msg": "操作成功",
      "code": 200,
      "data": {
          "role": 1,
          "userId": 9,
          "password": "$2a$10$7BuCsKboFEy.P/F5OHhLhunKVnm3CqlqM3yMUMUH022Rd8ePmvt2K",
          "username": "ss"
      }
  }
  ```

#### 3) 用户权限管理（仅限 Admin 用户）

- **资源标识**：/admin/permission/role
- **操作**：PUT
- **权限**：Admin 用户
- **请求 payload**：userId
- **应答 payload**：成功或失败的消息
- **说明：**根据userId修改roleId，Admin变成User或者User变成Admin
- **url:**http://localhost:20000/admin/permission/role
- **鉴权：**
  - 先登录user：![image-20240507225851810](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507225851810.png)
  - 返回jwt：![image-20240507225911664](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507225911664.png)
  - 用这个jwt：去访问该接口：![image-20240507225946752](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507225946752.png)出现不允许访问
  - 再登录ss（ADMIN）![image-20240507230103860](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230103860.png)
  - 用jwt去访问![image-20240507230127362](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230127362.png)
  - 出现success：![image-20240507230239325](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230239325.png)
  - 鉴权流程完毕




#### 4)用户权限列表（仅限 Admin 用户）

- **资源标识**：/admin/permission/list
- **操作**：GET
- **权限**：Admin 用户
- **请求 payload**：page,limit
- **应答 payload**：所有user和它们的role
- **鉴权：**同上

### 2. 博客或内容应用场景

#### 1) 获取用户内容信息

- **资源标识**：/user/content/list
- **操作**：GET
- **权限**：所有用户
- **请求 payload**：userId
- **应答 payload**：用户的内容信息，包括 id、title、contents、images 等
- USER权限的用户只能看到自己的content
- ![image-20240507230502656](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230502656.png)

#### 2) 获取所有用户内容信息

- **资源标识**：/admin/content/list

- **操作**：GET

- **权限**：Admin用户

- **请求 payload**：page，limit

- **应答 payload**：所有用户的内容信息，包括 id、title、contents、images 等

- ```
  {
      "msg": "success",
      "code": 0,
      "page": {
          "totalCount": 2,
          "pageSize": 10,
          "totalPage": 1,
          "currPage": 1,
          "list": [
              {
                  "id": 1,
                  "title": "哈哈",
                  "content": "哈哈",
                  "image": "https://img.qovv.cn/2024/05/07/6639db4138b0d.png",
                  "userid": 12
              },
              {
                  "id": 2,
                  "title": "嘎嘎",
                  "content": "嘎嘎",
                  "image": "https://img2.imgtp.com/2024/05/07/ZdkM1nAz.png",
                  "userid": 9
              }
          ]
      }
  }
  ```

- ![image-20240507230438476](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230438476.png)

	## Restful API 的后端设计与实现 

+ springboot+security+jwt+mybatis+redis实现
+ 数据库信息
  + ![image-20240507230808266](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230808266.png)
  + 见具体数据见sql文件

## 博客/内容前端的实现 

+ vue+elementUI实现
  + axois请求后端接口
+ 功能
  + 用户登录
    + ![image-20240507230924723](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230924723.png)
  + 用户注册
    + ![image-20240507230935385](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507230935385.png)
  + 前端内容展示：
    + ![image-20240507231008922](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507231008922.png)
  + Admin用户修改权限
    + ![image-20240507231032356](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507231032356.png)
    + user用户加载不出来
      + ![image-20240507231119378](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20240507231119378.png)



